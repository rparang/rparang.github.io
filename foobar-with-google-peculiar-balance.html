<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reza Parang - Foobar with Google: Peculiar Balance</title>
  <link rel="stylesheet" href="./theme/css/application.css">
  <link rel="stylesheet" href="./theme/css/pure.css">
  <link rel="stylesheet" href="./theme/css/grids.css">
  <link rel="stylesheet" href="./theme/css/font-awesome.css">
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F9Q82MH7HE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F9Q82MH7HE');
</script>

<body>
  <div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-5">
      <div class="sidebar-wrapper">
        <a class="logo" href=".">Reza Parang</a>
        <div class="icons">
          <a href="https://github.com/rparang" target="_blank"><span class="fa fa-github-square"></span></a>
          <a href="http://www.linkedin.com/in/rezaparang" target="_blank"><span class="fa fa-linkedin-square"></span></a>
          <a href="https://twitter.com/RezaParang" target="_blank"><span class="fa fa-twitter-square"></span></a>
        </div>
        <p class="bio">I write here about my projects.</p>
      </div>
    </div>
    <div class="content pure-u-1 pure-u-md-4-5">
<article class="entry" data-tag="">
  <header>
    <h1>Foobar with Google: Peculiar Balance</h1>
  </header>
  <section>
    <p><em>Originally published in July 2014</em></p>
<p>There has been <a href="https://news.ycombinator.com/item?id=8588080">recent</a> <a href="https://www.businessinsider.com/google-hiring-developers-foobar-challenge-2014-11">buzz</a> about a Google recruiting method called <a href="https://foobar.withgoogle.com/">Foobar</a>. Supposedly if you search enough programming-related issues like "python mutex lock," your account is flagged and you're offered to play a game with a series of programming challenges. If you do well, people claim you're invited for an interview.</p>
<p>Well, I wasn't offered to play this game. Thankfully, my friend was, and he shared one of the challenges below:</p>
<blockquote>
<h3>Peculiar balance</h3>
<p>Can we save them? Beta Rabbit is trying to break into a lab that contains the only known zombie cure - but there's an obstacle. The door will only open if a challenge is solved correctly. The future of the zombified rabbit population is at stake, so Beta reads the challenge:</p>
<p>There is a scale with an object on the left-hand side, whose mass is given in some number of units. Predictably, the task is to balance the two sides. But there is a catch: You only have this peculiar weight set, having masses 1, 3, 9, 27, ... units. That is, one for each power of 3. Being a brilliant mathematician, Beta Rabbit quickly discovers that any number of units of mass can be balanced exactly using this set.</p>
<p>To help Beta get into the room, write a method called <code>answer(x)</code>, which outputs a list of strings representing where the weights should be placed, in order for the two sides to be balanced, assuming that weight on the left has mass x units.</p>
<p>The first element of the output list should correspond to the 1-unit weight, the second element to the 3-unit weight, and so on. Each string is one of:</p>
<ul>
<li><code>"L"</code> : put weight on left-hand side  </li>
<li><code>"R"</code> : put weight on right-hand side  </li>
<li><code>"-"</code> : do not use weight  </li>
</ul>
<p>To ensure that the output is the smallest possible, the last element of the list must not be <code>"-"</code>.</p>
<p><code>x</code> will always be a positive integer, no larger than 1,000,000,000.</p>
<h4>Test cases</h4>
<p>Inputs: <code>(int) x = 2</code><br>
Output: <code>(string list) ["L", "R"]</code>  </p>
<p>Inputs: <code>(int) x = 8</code><br>
Output: <code>(string list) ["L", "-", "R"]</code></p>
</blockquote>
<p>The idea that any mass on the scale can be balanced using weights with only powers of three (with only one weight per power of 3) doesn't seem intuitive.</p>
<p>It turns out this challenge has its roots in ternary, a base-3 numeral system similar to binary. And there is a way of representing ternary in a balanced form, where each digit is represented with either "+", "0", or "-" (or something similar). Using this system, <em>any</em> number can be represented. I find this fact fascinating.</p>
<p>For example, the number 23 in the decimal system in ternary is 212 (<code>2*3^0 + 1*3^1 + 2*3^2</code>). We can represent 212 in a balanced form as <code>+0--</code> the following way: moving from right to left, convert each 2 value to a "-+", where the + takes the 2's position and the negative character is carried to the next column. The negative carried value is added to the existing column and the process continues. There are <a href="https://en.wikipedia.org/wiki/Balanced_ternary#Conversion_from_ternary">nice write-ups</a> on conversion to ternary.</p>
<p>This method seems ideal for our challenge.</p>
<p>First, we'll convert our initial scale value to ternary with a <code>decimal_to_ternary(num)</code> method. Then, we'll balance the ternary result using <code>balance(num)</code> based on our strategy above, taking into account that we'll represent our "+", "0", and "-" characters as either <code>"L"</code>, <code>"R"</code>, and <code>"-"</code>.</p>
<p>A JavaScript method for converting to ternary with a few comments is below:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">decimal_to_ternary</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">num</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">  </span><span class="c1">// Looking for the largest power of 3 where 3^i</span>
<span class="w">  </span><span class="c1">// is not larger than num. Add 0&#39;s for the index </span>
<span class="w">  </span><span class="c1">// in the meantime</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="nx">num</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">num</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">      </span><span class="nx">i</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// We leave our loop with i being 1 too large</span>
<span class="w">    </span><span class="nx">i</span><span class="o">--</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Since we can use up to 2, see if we can fit 2</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nx">num</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span><span class="w"> </span>
<span class="w">      </span><span class="nx">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">num</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">result</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">      </span><span class="nx">num</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">num</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>

<p>Next, we can take the result and balance it with our challenge's notation:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">balance</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">carry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="p">,</span><span class="w"> </span><span class="nx">temp</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Need to turn our number into an array. Reversing it since</span>
<span class="w">  </span><span class="c1">// we&#39;re working right to left through the conversion</span>
<span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">num</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">reverse</span><span class="p">().</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">carry</span><span class="p">;</span>
<span class="w">    </span><span class="nx">carry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">switch</span><span class="p">(</span><span class="nx">temp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="mf">3</span><span class="o">:</span>
<span class="w">        </span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">carry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="mf">2</span><span class="o">:</span>
<span class="w">        </span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;L&quot;</span>
<span class="w">        </span><span class="nx">carry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">case</span><span class="w"> </span><span class="mf">1</span><span class="o">:</span>
<span class="w">        </span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;R&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="k">default</span><span class="o">:</span>
<span class="w">        </span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">carry</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">array</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;R&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">array</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>With these two, we can solve our problem:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">answer</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">balance</span><span class="p">(</span><span class="nx">decimal_to_ternary</span><span class="p">(</span><span class="nx">num</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>

<p>We can test this by running <code>answer(546)</code> for the scenario where our rabbit super hero sees an initial weight of 546 on the left side of the scale. Our output list becomes <code>["-", "L", "R", "L", "R", "L", "R"]</code>, where our left side is <code>546 + 3^1 + 3^3 + 3^5</code> and our right side is <code>3^2 + 3^4 + 3^6</code>. Both sides become balanced at a weight of 819.</p>
<p>As a side note: This is likely not an efficient way to solve this problem. It's possible to convert a decimal number directly to balanced ternary, but breaking the steps up helped me better learn the process.</p>
  </section>
</article>
    </div>
  </div>
</body>
</html>